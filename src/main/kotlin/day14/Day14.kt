package day14

import whileTrue

fun main() {
    println(part1())
    println(part2())
}

fun part1(): Int {
    val world = World.from(buildStructure(input))
    whileTrue { world.addSand(500 to 0) }
    println("height: ${world.height}")
    println("width: ${world.width}")
    return world.numberOfSandSpots()
}

fun part2(): Int {
    val world = World.from(buildStructure(input), true)
    whileTrue { world.addSand(500 to 0) }
    println("height: ${world.height}")
    println("width: ${world.width}")
    return world.numberOfSandSpots()
}

enum class Spot {
    Empty,
    Rock,
    Sand
}

fun Spot?.isSolid(): Boolean = this == Spot.Rock || this == Spot.Sand
typealias Position = Pair<Int, Int>

val Position.x
    get() = first
val Position.y
    get() = second
typealias Way = List<Position>
typealias Structure = List<Way>
typealias Line = Pair<Position, Position>

data class World(private val grid: List<MutableList<Spot>>) {
    val height: Int
        get() = grid.size
    val width: Int
        get() = grid.firstOrNull()?.size ?: 0

    fun numberOfSandSpots(): Int {
        return grid.sumOf { row -> row.count { spot -> spot == Spot.Sand } }
    }

    tailrec fun addSand(position: Position): Boolean {
        // self not settable -> false
        val thisSpot = get(position)
        if (thisSpot == null || thisSpot.isSolid()) {
            return false
        }
        // below empty -> go below
        val below = position.x to position.y + 1
        if (get(below) == Spot.Empty) {
            return addSand(below)
        }
        // left below empty -> go left below
        val belowLeft = below.x - 1 to below.y
        if (get(belowLeft) == Spot.Empty) {
            return addSand(belowLeft)
        }
        // right below empty -> go right below
        val belowRight = below.x + 1 to below.y
        if (get(belowRight) == Spot.Empty) {
            return addSand(belowRight)
        }
        // below solid -> set and true
        if (get(below).isSolid()) {
            placeSand(position)
            return true
        }
        return false
    }

    private fun get(position: Position): Spot? = grid.elementAtOrNull(position.y)?.elementAtOrNull(position.x)

    private fun placeSand(position: Position) {
        grid[position.y][position.x] = Spot.Sand
    }

    companion object {
        fun from(structure: Structure, partTwo: Boolean = false): World {
            val height = structure.maxOf { way -> way.maxOf { point -> point.y } } + 1 + if (partTwo) {
                2
            } else {
                0
            }
            val width = structure.maxOf { way -> way.maxOf { point -> point.x } } + 1 + if (partTwo) {
                height
            } else {
                0
            }
            val grid = mutableListOf<MutableList<Spot>>()
            (0 until height).forEach { y ->
                grid.add(mutableListOf())
                repeat((0 until width).count()) {
                    grid[y].add(Spot.Empty)
                }
            }
            structure.forEach { way ->
                way.zipWithNext().forEach { line ->
                    line.forPositions { position ->
                        grid[position.y][position.x] = Spot.Rock
                    }
                }
            }
            if (partTwo) {
                grid.last().forEachIndexed() { x, _ ->
                    grid.last()[x] = Spot.Rock
                }
            }
            return World(grid)
        }
    }
}

fun buildStructure(input: String): Structure = input.lines().map { wayFrom(it) }

fun wayFrom(input: String): Way = input.split(" -> ").map { positionFrom(it) }

fun positionFrom(input: String): Position {
    val (x, y) = input.split(',')
    return x.toInt() to y.toInt()
}

fun Line.forPositions(action: (Position) -> Unit) {
    if (first.x == second.x) {
        val x = first.x
        val startY = minOf(first.y, second.y)
        val endY = maxOf(first.y, second.y)
        (startY..endY).forEach { y ->
            action(x to y)
        }
    } else if (first.y == second.y) {
        val y = first.y
        val startX = minOf(first.x, second.x)
        val endX = maxOf(first.x, second.x)
        (startX..endX).forEach { x ->
            action(x to y)
        }
    } else {
        throw IllegalArgumentException("")
    }
}

private const val testInput = """498,4 -> 498,6 -> 496,6
503,4 -> 502,4 -> 502,9 -> 494,9"""

private const val input =
    """508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
521,153 -> 521,155 -> 519,155 -> 519,158 -> 530,158 -> 530,155 -> 525,155 -> 525,153
507,19 -> 511,19
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
507,88 -> 507,91 -> 503,91 -> 503,96 -> 519,96 -> 519,91 -> 513,91 -> 513,88
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
494,34 -> 499,34
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
490,31 -> 495,31
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
497,108 -> 501,108
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
482,25 -> 487,25
521,153 -> 521,155 -> 519,155 -> 519,158 -> 530,158 -> 530,155 -> 525,155 -> 525,153
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
495,124 -> 495,127 -> 489,127 -> 489,131 -> 503,131 -> 503,127 -> 500,127 -> 500,124
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
495,124 -> 495,127 -> 489,127 -> 489,131 -> 503,131 -> 503,127 -> 500,127 -> 500,124
517,79 -> 522,79
498,17 -> 502,17
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
479,28 -> 484,28
478,37 -> 478,39 -> 474,39 -> 474,43 -> 487,43 -> 487,39 -> 480,39 -> 480,37
478,37 -> 478,39 -> 474,39 -> 474,43 -> 487,43 -> 487,39 -> 480,39 -> 480,37
501,19 -> 505,19
507,88 -> 507,91 -> 503,91 -> 503,96 -> 519,96 -> 519,91 -> 513,91 -> 513,88
478,37 -> 478,39 -> 474,39 -> 474,43 -> 487,43 -> 487,39 -> 480,39 -> 480,37
501,15 -> 505,15
511,60 -> 522,60
509,108 -> 513,108
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
513,76 -> 518,76
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
497,31 -> 502,31
501,34 -> 506,34
503,134 -> 512,134 -> 512,133
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
500,99 -> 504,99
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
478,37 -> 478,39 -> 474,39 -> 474,43 -> 487,43 -> 487,39 -> 480,39 -> 480,37
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
521,153 -> 521,155 -> 519,155 -> 519,158 -> 530,158 -> 530,155 -> 525,155 -> 525,153
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
521,153 -> 521,155 -> 519,155 -> 519,158 -> 530,158 -> 530,155 -> 525,155 -> 525,153
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
514,82 -> 519,82
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
495,15 -> 499,15
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
498,13 -> 502,13
485,22 -> 490,22
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
478,37 -> 478,39 -> 474,39 -> 474,43 -> 487,43 -> 487,39 -> 480,39 -> 480,37
511,85 -> 516,85
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
473,34 -> 478,34
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
495,124 -> 495,127 -> 489,127 -> 489,131 -> 503,131 -> 503,127 -> 500,127 -> 500,124
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
483,31 -> 488,31
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
500,105 -> 504,105
521,82 -> 526,82
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
503,102 -> 507,102
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
487,34 -> 492,34
503,108 -> 507,108
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
489,25 -> 494,25
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
492,17 -> 496,17
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
495,19 -> 499,19
504,85 -> 509,85
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
508,150 -> 521,150
507,82 -> 512,82
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
478,37 -> 478,39 -> 474,39 -> 474,43 -> 487,43 -> 487,39 -> 480,39 -> 480,37
480,34 -> 485,34
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
506,105 -> 510,105
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
503,134 -> 512,134 -> 512,133
497,102 -> 501,102
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
489,19 -> 493,19
507,88 -> 507,91 -> 503,91 -> 503,96 -> 519,96 -> 519,91 -> 513,91 -> 513,88
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
495,124 -> 495,127 -> 489,127 -> 489,131 -> 503,131 -> 503,127 -> 500,127 -> 500,124
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
521,153 -> 521,155 -> 519,155 -> 519,158 -> 530,158 -> 530,155 -> 525,155 -> 525,153
495,124 -> 495,127 -> 489,127 -> 489,131 -> 503,131 -> 503,127 -> 500,127 -> 500,124
517,73 -> 517,69 -> 517,73 -> 519,73 -> 519,71 -> 519,73 -> 521,73 -> 521,72 -> 521,73 -> 523,73 -> 523,69 -> 523,73 -> 525,73 -> 525,69 -> 525,73 -> 527,73 -> 527,65 -> 527,73
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
507,88 -> 507,91 -> 503,91 -> 503,96 -> 519,96 -> 519,91 -> 513,91 -> 513,88
486,28 -> 491,28
507,88 -> 507,91 -> 503,91 -> 503,96 -> 519,96 -> 519,91 -> 513,91 -> 513,88
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
495,124 -> 495,127 -> 489,127 -> 489,131 -> 503,131 -> 503,127 -> 500,127 -> 500,124
491,108 -> 495,108
476,31 -> 481,31
508,56 -> 508,49 -> 508,56 -> 510,56 -> 510,51 -> 510,56 -> 512,56 -> 512,49 -> 512,56 -> 514,56 -> 514,52 -> 514,56
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
525,85 -> 530,85
510,163 -> 524,163 -> 524,162
482,121 -> 482,120 -> 482,121 -> 484,121 -> 484,113 -> 484,121 -> 486,121 -> 486,115 -> 486,121 -> 488,121 -> 488,114 -> 488,121 -> 490,121 -> 490,120 -> 490,121 -> 492,121 -> 492,116 -> 492,121 -> 494,121 -> 494,112 -> 494,121 -> 496,121 -> 496,120 -> 496,121
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
504,17 -> 508,17
521,153 -> 521,155 -> 519,155 -> 519,158 -> 530,158 -> 530,155 -> 525,155 -> 525,153
521,153 -> 521,155 -> 519,155 -> 519,158 -> 530,158 -> 530,155 -> 525,155 -> 525,153
493,28 -> 498,28
494,105 -> 498,105
507,88 -> 507,91 -> 503,91 -> 503,96 -> 519,96 -> 519,91 -> 513,91 -> 513,88
495,124 -> 495,127 -> 489,127 -> 489,131 -> 503,131 -> 503,127 -> 500,127 -> 500,124
507,88 -> 507,91 -> 503,91 -> 503,96 -> 519,96 -> 519,91 -> 513,91 -> 513,88
510,79 -> 515,79
510,163 -> 524,163 -> 524,162
478,37 -> 478,39 -> 474,39 -> 474,43 -> 487,43 -> 487,39 -> 480,39 -> 480,37
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147
518,85 -> 523,85
492,147 -> 492,138 -> 492,147 -> 494,147 -> 494,140 -> 494,147 -> 496,147 -> 496,138 -> 496,147 -> 498,147 -> 498,143 -> 498,147 -> 500,147 -> 500,137 -> 500,147 -> 502,147 -> 502,137 -> 502,147 -> 504,147 -> 504,146 -> 504,147 -> 506,147 -> 506,145 -> 506,147 -> 508,147 -> 508,138 -> 508,147 -> 510,147 -> 510,143 -> 510,147"""